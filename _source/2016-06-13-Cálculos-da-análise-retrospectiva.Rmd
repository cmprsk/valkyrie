---
layout: post
title:  "Cálculos da análise retrospectiva"
date:   2016-06-13 16:03:45 -0300
categories: metodologia
---

## Curva de sobrevida da análise retrospectiva:

Esta postagem usa o pacote [_knitr_](http://yihui.name/knitr/) para calcular os resultados ao mesmo tempo em que compila a página em html com [_jekyll_](https://jekyllrb.com/).
Utilizei, como guia, o excelente exemplo de [_yihui_](https://github.com/yihui/knitr).

```{r warning=F, message=F}
require(knitr)
require(RCurl)
require(survival)
dipg<-read.csv(text = getURL("https://raw.githubusercontent.com/fhcflx/valkyrie/gh-pages/assets/stat/dipg.csv"))
```

```{r Sobrevida, fig.height=10, fig.width=12, fig.cap='Sobrevida de pacientes com DIPG'}
plot(survfit(Surv(surv,status)~1,dipg),xlab="Meses")
```

Grupo de pacientes com diagnóstico de DIPG tratados em nosso serviço, entre 2000 e 2013. O gráfico mostra a estimativa de probabilidade de sobrevida, calculada pelo método de Kaplan-Meier, usando a linguagem de programação R, pacote *survival*. O pacote *RCurl* foi adicionalmente utilizado para capturar os dados a partir do arquivo [.csv](https://github.com/fhcflx/valkyrie/blob/gh-pages/assets/stat/dipg.csv) armazenado no repositório do github. O gráfico mostra também o intervalo de confiança 95%.
Este é o resumo da variável de sobrevida, além da sobrevida em 12 meses e tempo de follow-up:

```{r echo=F}
survfit(Surv(surv,status)~1,dipg)
```

```{r echo=F}
summary(survfit(Surv(surv,status)~1,dipg),time=12)
```

Mostrando uma mediana de sobrevida de `r summary(survfit(Surv(surv,status)~1,dipg))$table[5]` meses e sobrevida em 12 meses de `r round(summary(survfit(Surv(surv,status)~1,dipg),time=12)$surv,3)*100` %.

```{r echo=F}
survfit(Surv(surv,ifelse(status<1,1,0))~1,dipg)
```

Mostrando uma mediana de follow-up de `r summary(survfit(Surv(surv,ifelse(status<1,1,0))~1,dipg))$table[5]` meses.

Aqui, o gráfico comparativo entre os pacientes que fizeram QT segundo um esquema HIT e os outros pacientes:

```{r Sobrevida2, fig.height=10, fig.width=12, fig.cap='Sobrevida de pacientes com DIPG, divididos por tratamento'}
plot(survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg),xlab="Meses")
```
E o resumo da sobrevida nos 2 grupos, com sobrevida aos 12 meses:
```{r echo=F}
survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg)
```
```{r echo=F}
summary(survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg),time=12)
```

Mostrando uma sobrevida aos 12 meses de `r round(summary(survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg),time=12)$surv[2],3)*100` % para o grupo tratado com protocolo _as per_ HIT (n = `r summary(survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg),time=12)$n[2]` ) e de `r round(summary(survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg),time=12)$surv[1],3)*100` % para os demais (n = `r summary(survfit(Surv(surv,status)~ifelse(QT1<10,0,1),dipg),time=12)$n[1]` ).
